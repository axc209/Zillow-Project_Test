# Keep columns
keep_columns = [
    "ZPID",
    "abbreviatedAddress",
    "bathrooms",
    "bedrooms",
    "brokerIdDimension",
    "brokerageName",
    "buildingId",
    "city",
    "country",
    "county",
    "datePostedString",
    "datePriceChanged",
    "dateSold",
    "dateSoldString",
    "daysOnZillow",
    "description",
    "favoriteCount",
    "foreclosureAmount",
    "hasVRModel",
    "hdpTypeDimension",
    "homeInsights",
    "homeStatus",
    "homeType",
    "isListedByOwner",
    "isPremierBuilder",
    "isRentalListingOffMarket",
    "keystoneHomeStatus",
    "latitude",
    "listPriceLow",
    "livingArea",
    "livingAreaUnits",
    "livingAreaUnitsShort",
    "longitude",
    "lotSize",
    "monthlyHoaFee",
    "moveInReady",
    "pageViewCount",
    "photoCount",
    "postingProductType",
    "price",
    "priceChange",
    "priceChangeDate",
    "priceChangeDateString",
    "priceHistory",
    "propertyTaxRate",
    "propertyTypeDimension",
    "regionString",
    "rentZestimate",
    "rentalApplicationsAcceptedType",
    "restimateHighPercent",
    "restimateLowPercent",
    "schools",
    "sellingSoon",
    "taxAssessedValue",
    "taxAssessedYear",
    "taxHistory",
    "timeZone",
    "tourViewCount",
    "yearBuilt",
    "zestimate",
    "zestimateHighPercent",
    "zestimateLowPercent",
    "address.subdivision",
    "downPaymentAssistance.maxAssistance",
    "downPaymentAssistance.resultCount",
    "foreclosureTypes.isBankOwned",
    "listing_agent.display_name",
    "listing_agent.first_name",
    "listing_agent.rating_average",
    "listing_agent.recent_sales",
    "listing_agent.review_count",
    "mortgageRates.arm5Rate",
    "mortgageRates.fifteenYearFixedRate",
    "mortgageRates.thirtyYearFixedRate",
    "resoFacts.accessibilityFeatures",
    "resoFacts.appliances",
    "resoFacts.architecturalStyle",
    "resoFacts.associationAmenities",
    "resoFacts.associationFee",
    "resoFacts.associationFeeIncludes",
    "resoFacts.atAGlanceFacts",
    "resoFacts.availabilityDate",
    "resoFacts.basement",
    "resoFacts.basementYN",
    "resoFacts.bathrooms",
    "resoFacts.bathroomsFull",
    "resoFacts.bathroomsHalf",
    "resoFacts.bathroomsOneQuarter",
    "resoFacts.bathroomsThreeQuarter",
    "resoFacts.bedrooms",
    "resoFacts.builderModel",
    "resoFacts.builderName",
    "resoFacts.buildingArea",
    "resoFacts.buildingAreaSource",
    "resoFacts.buyerAgencyCompensation",
    "resoFacts.buyerAgencyCompensationType",
    "resoFacts.canRaiseHorses",
    "resoFacts.carportSpaces",
    "resoFacts.cityRegion",
    "resoFacts.communityFeatures",
    "resoFacts.constructionMaterials",
    "resoFacts.cooling",
    "resoFacts.coveredSpaces",
    "resoFacts.daysOnZillow",
    "resoFacts.depositsAndFees",
    "resoFacts.electric",
    "resoFacts.elementarySchool",
    "resoFacts.elementarySchoolDistrict",
    "resoFacts.entryLocation",
    "resoFacts.exclusions",
    "resoFacts.exteriorFeatures",
    "resoFacts.fencing",
    "resoFacts.fireplaceFeatures",
    "resoFacts.fireplaces",
    "resoFacts.flooring",
    "resoFacts.foundationDetails",
    "resoFacts.furnished",
    "resoFacts.garageSpaces",
    "resoFacts.greenEnergyEfficient",
    "resoFacts.greenIndoorAirQuality",
    "resoFacts.greenSustainability",
    "resoFacts.greenWaterConservation",
    "resoFacts.hasAdditionalParcels",
    "resoFacts.hasAssociation",
    "resoFacts.hasAttachedGarage",
    "resoFacts.hasAttachedProperty",
    "resoFacts.hasCarport",
    "resoFacts.hasCooling",
    "resoFacts.hasFireplace",
    "resoFacts.hasGarage",
    "resoFacts.hasHeating",
    "resoFacts.hasHomeWarranty",
    "resoFacts.hasLandLease",
    "resoFacts.hasOpenParking",
    "resoFacts.hasPrivatePool",
    "resoFacts.hasSpa",
    "resoFacts.hasView",
    "resoFacts.hasWaterfrontView",
    "resoFacts.heating",
    "resoFacts.highSchool",
    "resoFacts.highSchoolDistrict",
    "resoFacts.hoaFee",
    "resoFacts.homeType",
    "resoFacts.horseYN",
    "resoFacts.interiorFeatures",
    "resoFacts.isNewConstruction",
    "resoFacts.isSeniorCommunity",
    "resoFacts.laundryFeatures",
    "resoFacts.leaseTerm",
    "resoFacts.levels",
    "resoFacts.listingTerms",
    "resoFacts.livingArea",
    "resoFacts.livingAreaRangeUnits",
    "resoFacts.lotFeatures",
    "resoFacts.lotSize",
    "resoFacts.lotSizeDimensions",
    "resoFacts.middleOrJuniorSchool",
    "resoFacts.middleOrJuniorSchoolDistrict",
    "resoFacts.onMarketDate",
    "resoFacts.openParkingSpaces",
    "resoFacts.otherEquipment",
    "resoFacts.otherFacts",
    "resoFacts.otherParking",
    "resoFacts.otherStructures",
    "resoFacts.ownership",
    "resoFacts.parcelNumber",
    "resoFacts.parking",
    "resoFacts.parkingFeatures",
    "resoFacts.patioAndPorchFeatures",
    "resoFacts.poolFeatures",
    "resoFacts.pricePerSquareFoot",
    "resoFacts.propertyCondition",
    "resoFacts.propertySubType",
    "resoFacts.roadSurfaceType",
    "resoFacts.roofType",
    "resoFacts.rooms",
    "resoFacts.securityFeatures",
    "resoFacts.sewer",
    "resoFacts.spaFeatures",
    "resoFacts.specialListingConditions",
    "resoFacts.stories",
    "resoFacts.storiesTotal",
    "resoFacts.structureType",
    "resoFacts.subdivisionName",
    "resoFacts.taxAnnualAmount",
    "resoFacts.topography",
    "resoFacts.utilities",
    "resoFacts.vegetation",
    "resoFacts.waterBodyName",
    "resoFacts.waterSource",
    "resoFacts.waterView",
    "resoFacts.waterViewYN",
    "resoFacts.waterfrontFeatures",
    "resoFacts.windowFeatures",
    "resoFacts.yearBuilt",
    "resoFacts.yearBuiltEffective",
]

drop_list = [
    "big",
    "hdpUrl",
    "hiResImageLink",
    "hugePhotos",
    "mapTileGoogleMapUrlFullWidthLightbox",
    "mediumImageLink",
    "nearbyCities",
    "nearbyHomes",
    "nearbyNeighborhoods",
    "nearbyZipcodes",
    "openHouseSchedule",
    "pals",
    "photos",
    "postingUrl",
    "responsivePhotos",
    "responsivePhotosOriginalRatio",
    "streetViewMetadataUrlMapLightboxAddress",
    "streetViewMetadataUrlMediaWallAddress",
    "streetViewMetadataUrlMediaWallLatLong",
    "streetViewServiceUrl",
    "streetViewTileImageUrlMediumAddress",
    "streetViewTileImageUrlMediumLatLong",
    "thumb",
    "tourPhotos",
    "virtualTourUrl",
    "apartmentsForRentInZipcodeSearchUrl.path",
    "attributionInfo.infoString10",
    "attributionInfo.listingAgents",
    "attributionInfo.listingOffices",
    "attributionInfo.mlsDisclaimer",
    "citySearchUrl.path",
    "formattedChip.location",
    "homeRecommendations.blendedRecs",
    "housesForRentInZipcodeSearchUrl.path",
    "listing_agent.image_data.url",
    "listing_agent.profile_url",
    "listing_agent.reviews_url",
    "listing_agent.services_offered",
    "listing_agent.username",
    "listing_agent.write_review_url",
    "onsiteMessage.eventId",
    "onsiteMessage.messages",
    "resoFacts.view",
    "resoFacts.virtualTour",
    "resoFacts.virtualTourURLUnbranded",
    "stateSearchUrl.path",
    "staticMap.sources",
    "streetView.addressSources",
    "streetView.latLongSources",
    "thirdPartyVirtualTour.externalUrl",
    "thirdPartyVirtualTour.lightboxUrl",
    "thirdPartyVirtualTour.providerKey",
    "thirdPartyVirtualTour.providerName",
    "thirdPartyVirtualTour.staticUrl",
    "tourEligibility.isPropertyTourEligible",
    "vrModel.cdnHost",
    "vrModel.revisionId",
    "vrModel.vrModelGuid",
    "zipcodeSearchUrl.path",
    "neighborhoodSearchUrl.path",
    "listing_agent.phone",
    "listingProvider.logos",
    "listingProvider.postingWebsiteURL",
    "listingProvider.sourceText",
    "listingProvider.title",
    "communityUrl.path",
    "richMedia.floorPlan",
    "richMedia.imx",
    "richMedia.virtualTour",
    "foreclosureMoreInfo.apn",
    "foreclosureMoreInfo.legalDescription",
    "foreclosureMoreInfo.recordedDocs",
]

drop_list_1 = [
    "desktopWebHdpImageLink",
    "floorMaps",
    "mapTileGoogleMapUrlFullWidthLightboxWholeZipcode",
    "mapTileGoogleMapUrlFullWidthMax",
    "mapTileGoogleMapUrlFullWidthMaxWholeZipcode",
    "mapTileGoogleMapUrlSmall",
    "mapTileGoogleMapUrlSmallWholeZipcode",
]

# Specify the columns and their types (dict or list of dicts)
columns_to_expand = {
    "homeInsights": "dict",
    "priceHistory": "list",
    "schools": "list",
    "sellingSoon": "dict",
    "taxHistory": "list",
    "resoFacts.atAGlanceFacts": "list",
    "resoFacts.rooms": "list",
}

# List of columns that contain lists to be separated into individual columns
columnns_containing_lists = [
    "resoFacts.accessibilityFeatures",
    "resoFacts.appliances",
    "resoFacts.communityFeatures",
    "resoFacts.constructionMaterials",
    "resoFacts.cooling",
    "resoFacts.exclusions",
    "resoFacts.exteriorFeatures",
    "resoFacts.fireplaceFeatures",
    "resoFacts.flooring",
    "resoFacts.foundationDetails",
    "resoFacts.greenEnergyEfficient",
    "resoFacts.greenIndoorAirQuality",
    "resoFacts.greenSustainability",
    "resoFacts.greenWaterConservation",
    "resoFacts.heating",
    "resoFacts.interiorFeatures",
    "resoFacts.laundryFeatures",
    "resoFacts.lotFeatures",
    "resoFacts.otherEquipment",
    "resoFacts.otherStructures",
    "resoFacts.parkingFeatures",
    "resoFacts.patioAndPorchFeatures",
    "resoFacts.poolFeatures",
    "resoFacts.propertySubType",
    "resoFacts.roadSurfaceType",
    "resoFacts.securityFeatures",
    "resoFacts.sewer",
    "resoFacts.spaFeatures",
    "resoFacts.utilities",
    "resoFacts.vegetation",
    "resoFacts.waterSource",
    "resoFacts.waterfrontFeatures",
    "resoFacts.windowFeatures",
]

drop_list_2 = [
    "buildingId",
    "description",
    "hdpTypeDimension",
    "homeStatus",
    "livingAreaUnits",
    "propertyTypeDimension",
    "regionString",
    "resoFacts.otherFacts",
    "resoFacts.parcelNumber",
    "homeInsights_0",
    "priceHistory_attributeSource",
    "priceHistory_buyerAgent",
    "priceHistory_sellerAgent",
    "schools_link",
    "resoFacts.atAGlanceFacts_factValue",
]
